---
title: "Table of Canadian Prime Minister Lifespans Scraped from Wikipedia"
subtitle: "Week 7 tutorial"
author: Francesca Ye
date: today
date-format: long
format: html
toc: true
number-sections: true
---
```{r}
#| message: false
#| echo: false
#| warning: false
#### Work space set-up ####

# Load packages
library(rvest)
library(xml2)
library(dplyr)
library(janitor)
library(tidyr)
library(stringr)
library(knitr)
library(ggplot2)
library(retroharmonize)

#### Read and Write Raw Data ####
# All code referenced from "https://tellingstorieswithdata.com/07-gather.html#prime-ministers-of-the-united-kingdom"

cleaned_data <-
  read.csv(
    file = "~/aus_pm_lifespan/outputs/data/00-cleaned_aus_pm_data.csv",
    show_col_types = FALSE
  )

```

```{r}
#| warning: false
#| message: false
#| echo: false
#| label: tbl-cleaned
#| tbl-cap: Full Table of Australian Prime Ministers and their Age at Death

# Code referenced from "https://tellingstorieswithdata.com/07-gather.html#prime-ministers-of-the-united-kingdom"
cleaned_data |>
  head() |>
  kable(
    col.names = c("Prime Minister", "Birth Year", "Death Year", "Age at death")
    )
```

```{r}
#| warning: false
#| message: false
#| echo: false
#| label: fig-cleaned
#| tbl-cap: Australian Prime Ministers and their Age at Death

# Code referenced from "https://tellingstorieswithdata.com/07-gather.html#prime-ministers-of-the-united-kingdom"
cleaned_data |>
  mutate(
    still_alive = if_else(is.na(died), "Yes", "No"),
    died = if_else(is.na(died), as.integer(2024), died)
  ) |>
  mutate(name = as_factor(name)) |>
  ggplot(
    aes(x = born, xend = died, y = name, yend = name, color = still_alive)
    ) +
  geom_segment() +
  labs(
    x = "Birth Year", y = "Prime Minister", color = "Living PM"
    ) +
  theme_minimal() +
  scale_color_brewer(palette = "Set1") +
  theme(legend.position = "bottom")
```

